import{d as V,b2 as _,i as L,ad as S,r as w,b3 as H,a9 as c,b4 as M,aa as z,j as I,aR as q,k as A,l as F,a1 as N}from"./index.e9727822.js";function O(l){return Math.floor(Math.abs(l))*Math.sign(l)}const Y=V({name:"VParallax",props:{scale:{type:[Number,String],default:.5}},setup(l,h){let{slots:g}=h;const{intersectionRef:o,isIntersecting:s}=_(),{resizeRef:x,contentRect:i}=L(),{height:P}=S(),n=w();H(()=>{var e;o.value=x.value=(e=n.value)==null?void 0:e.$el});let t;c(s,e=>{e?(t=M(o.value),t=t===document.scrollingElement?document:t,t.addEventListener("scroll",a,{passive:!0}),a()):t.removeEventListener("scroll",a)}),z(()=>{var e;(e=t)==null||e.removeEventListener("scroll",a)}),c(P,a),c(()=>{var e;return(e=i.value)==null?void 0:e.height},a);const u=I(()=>1-q(+l.scale));let v=-1;function a(){!s.value||(cancelAnimationFrame(v),v=requestAnimationFrame(()=>{var f,p;var e;const m=((e=n.value)==null?void 0:e.$el).querySelector(".v-img__img");if(!m)return;const d=(f=t.clientHeight)!=null?f:document.documentElement.clientHeight,$=(p=t.scrollTop)!=null?p:window.scrollY,b=o.value.offsetTop,r=i.value.height,R=b+(r-d)/2,y=O(($-R)*u.value),E=Math.max(1,(u.value*(d-r)+r)/r);m.style.setProperty("transform",`translateY(${y}px) scale(${E})`)}))}return A(()=>F(N,{class:["v-parallax",{"v-parallax--active":s.value}],ref:n,cover:!0,onLoadstart:a,onLoad:a},g)),{}}});export{Y as V};
